<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Interview Bot - Login</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }
        
        .container {
            width: 100%;
            max-width: 1000px;
            background: white;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.15);
            overflow: hidden;
            display: flex;
            flex-direction: column;
            height: 90vh;
        }
        
        header {
            background: #2c3e50;
            color: white;
            padding: 20px;
            text-align: center;
            position: relative;
        }
        
        h1 {
            font-size: 24px;
            margin-bottom: 5px;
        }
        
        .subtitle {
            font-size: 14px;
            opacity: 0.8;
        }
        
        .ai-indicator {
            position: absolute;
            right: 20px;
            top: 20px;
            display: flex;
            align-items: center;
            background: rgba(255, 255, 255, 0.2);
            padding: 5px 10px;
            border-radius: 15px;
            font-size: 12px;
        }
        
        .ai-pulse {
            width: 10px;
            height: 10px;
            background: #00e676;
            border-radius: 50%;
            margin-right: 5px;
            animation: pulse 1.5s infinite;
        }
        
        @keyframes pulse {
            0% { opacity: 0.4; }
            50% { opacity: 1; }
            100% { opacity: 0.4; }
        }
        
        .login-container {
            padding: 40px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            flex: 1;
        }
        
        .login-box {
            width: 100%;
            max-width: 400px;
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.1);
        }
        
        .login-title {
            text-align: center;
            margin-bottom: 24px;
            color: #2c3e50;
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            color: #555;
        }
        
        input[type="text"],
        input[type="password"] {
            width: 100%;
            padding: 12px 15px;
            border: 1px solid #ddd;
            border-radius: 6px;
            outline: none;
            font-size: 15px;
            transition: border-color 0.3s;
        }
        
        input[type="text"]:focus,
        input[type="password"]:focus {
            border-color: #3498db;
            box-shadow: 0 0 0 2px rgba(52, 152, 219, 0.2);
        }
        
        .btn {
            width: 100%;
            padding: 12px;
            background: #3498db;
            color: white;
            border: none;
            border-radius: 6px;
            font-size: 16px;
            cursor: pointer;
            transition: background 0.3s;
        }
        
        .btn:hover {
            background: #2980b9;
        }
        
        .register-link {
            text-align: center;
            margin-top: 20px;
            font-size: 14px;
            color: #555;
        }
        
        .register-link a {
            color: #3498db;
            text-decoration: none;
        }
        
        .register-link a:hover {
            text-decoration: underline;
        }
        
        .main-content {
            display: flex;
            flex: 1;
            overflow: hidden;
            display: none;
        }
        
        .info-panel {
            width: 280px;
            background: #f8f9fa;
            padding: 20px;
            border-right: 1px solid #eaeaea;
            display: flex;
            flex-direction: column;
            overflow-y: auto;
        }
        
        .user-info {
            display: flex;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 20px;
            border-bottom: 1px solid #eaeaea;
        }
        
        .user-avatar {
            width: 50px;
            height: 50px;
            background: #3498db;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            font-size: 20px;
            margin-right: 15px;
        }
        
        .user-details {
            flex: 1;
        }
        
        .user-name {
            font-weight: 600;
            margin-bottom: 4px;
        }
        
        .user-email {
            font-size: 13px;
            color: #777;
        }
        
        .logout-btn {
            background: #e74c3c;
            color: white;
            border: none;
            border-radius: 4px;
            padding: 6px 12px;
            font-size: 13px;
            cursor: pointer;
            transition: background 0.3s;
        }
        
        .logout-btn:hover {
            background: #c0392b;
        }
        
        .progress-container {
            margin-bottom: 25px;
        }
        
        .progress-label {
            display: flex;
            justify-content: space-between;
            margin-bottom: 5px;
            font-size: 14px;
            color: #555;
        }
        
        progress {
            width: 100%;
            height: 8px;
            border-radius: 4px;
        }
        
        .score-breakdown {
            margin: 20px 0;
        }
        
        .score-item {
            display: flex;
            justify-content: space-between;
            margin-bottom: 8px;
            font-size: 13px;
        }
        
        .score-bar {
            height: 6px;
            background: #eaeaea;
            border-radius: 3px;
            margin-top: 3px;
            overflow: hidden;
        }
        
        .score-fill {
            height: 100%;
            border-radius: 3px;
            transition: width 0.5s ease;
        }
        
        .current-evaluation {
            margin-top: 20px;
        }
        
        .evaluation-text {
            font-size: 13px;
            color: #555;
            margin-top: 8px;
            line-height: 1.5;
        }
        
        .chat-container {
            flex: 1;
            display: flex;
            flex-direction: column;
        }
        
        .chat-messages {
            flex: 1;
            padding: 20px;
            overflow-y: auto;
            display: flex;
            flex-direction: column;
            gap: 15px;
        }
        
        .message {
            max-width: 75%;
            padding: 12px 16px;
            border-radius: 18px;
            line-height: 1.4;
            position: relative;
        }
        
        .bot-message {
            background: #e8ebf0;
            border-top-left-radius: 5px;
            align-self: flex-start;
        }
        
        .user-message {
            background: #3498db;
            color: white;
            border-top-right-radius: 5px;
            align-self: flex-end;
        }
        
        .typing-indicator {
            display: none;
            padding: 12px 16px;
            background: #e8ebf0;
            border-radius: 18px;
            border-top-left-radius: 5px;
            align-self: flex-start;
            margin-bottom: 15px;
        }
        
        .typing-dots {
            display: flex;
            gap: 4px;
        }
        
        .typing-dot {
            width: 8px;
            height: 8px;
            background: #7f8c8d;
            border-radius: 50%;
            animation: typingAnimation 1.4s infinite ease-in-out;
        }
        
        .typing-dot:nth-child(1) { animation-delay: 0s; }
        .typing-dot:nth-child(2) { animation-delay: 0.2s; }
        .typing-dot:nth-child(3) { animation-delay: 0.4s; }
        
        @keyframes typingAnimation {
            0%, 60%, 100% { transform: translateY(0); }
            30% { transform: translateY(-5px); }
        }
        
        .input-area {
            padding: 15px;
            border-top: 1px solid #eaeaea;
            display: flex;
            gap: 10px;
            align-items: center;
        }
        
        input {
            flex: 1;
            padding: 12px 15px;
            border: 1px solid #ddd;
            border-radius: 20px;
            outline: none;
            font-size: 14px;
        }
        
        button {
            background: #3498db;
            color: white;
            border: none;
            border-radius: 20px;
            padding: 0 20px;
            height: 40px;
            cursor: pointer;
            font-weight: 500;
            transition: background 0.3s;
        }
        
        button:hover {
            background: #2980b9;
        }
        
        .results-container {
            padding: 25px;
            display: none;
            flex-direction: column;
            height: 100%;
        }
        
        .score-display {
            text-align: center;
            margin-bottom: 25px;
        }
        
        .score {
            font-size: 48px;
            font-weight: 700;
            color: #2c3e50;
        }
        
        .score-label {
            font-size: 18px;
            color: #7f8c8d;
        }
        
        .summary {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
        }
        
        .summary h3 {
            margin-bottom: 15px;
            color: #2c3e50;
        }
        
        .action-buttons {
            display: flex;
            gap: 10px;
            margin-top: auto;
        }
        
        .download-btn {
            flex: 1;
            padding: 15px;
            background: #2c3e50;
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            cursor: pointer;
            transition: background 0.3s;
        }
        
        .download-btn:hover {
            background: #1a252f;
        }
        
        .restart-btn {
            flex: 1;
            padding: 15px;
            background: white;
            color: #3498db;
            border: 1px solid #3498db;
            border-radius: 8px;
            font-size: 16px;
            cursor: pointer;
            transition: background 0.3s;
        }
        
        .restart-btn:hover {
            background: #f5f7fa;
        }
        
        .error-message {
            color: #e74c3c;
            font-size: 14px;
            margin-top: 8px;
            text-align: center;
            display: none;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>AI-Powered Interview Bot</h1>
            <div class="subtitle">Dynamic AI-driven screening assessment with real-time evaluation</div>
            <div class="ai-indicator">
                <div class="ai-pulse"></div>
                <span>AI Analyzing</span>
            </div>
        </header>
        
        <div class="login-container" id="login-container">
            <div class="login-box">
                <h2 class="login-title">Login to Your Account</h2>
                <form id="login-form">
                    <div class="form-group">
                        <label for="email">Email</label>
                        <input type="text" id="email" placeholder="Enter your email" required>
                    </div>
                    <div class="form-group">
                        <label for="password">Password</label>
                        <input type="password" id="password" placeholder="Enter your password" required>
                    </div>
                    <button type="submit" class="btn">Login</button>
                    <div class="error-message" id="login-error">Invalid email or password. Please try again.</div>
                </form>
                <div class="register-link">
                    Don't have an account? <a href="#" id="show-register">Register</a>
                </div>
            </div>
        </div>
        
        <div class="login-container" id="register-container" style="display: none;">
            <div class="login-box">
                <h2 class="login-title">Create an Account</h2>
                <form id="register-form">
                    <div class="form-group">
                        <label for="reg-name">Full Name</label>
                        <input type="text" id="reg-name" placeholder="Enter your full name" required>
                    </div>
                    <div class="form-group">
                        <label for="reg-email">Email</label>
                        <input type="text" id="reg-email" placeholder="Enter your email" required>
                    </div>
                    <div class="form-group">
                        <label for="reg-password">Password</label>
                        <input type="password" id="reg-password" placeholder="Create a password" required>
                    </div>
                    <div class="form-group">
                        <label for="reg-confirm">Confirm Password</label>
                        <input type="password" id="reg-confirm" placeholder="Confirm your password" required>
                    </div>
                    <button type="submit" class="btn">Register</button>
                    <div class="error-message" id="register-error">Passwords don't match or account already exists.</div>
                </form>
                <div class="register-link">
                    Already have an account? <a href="#" id="show-login">Login</a>
                </div>
            </div>
        </div>
        
        <div class="main-content" id="main-content">
            <div class="info-panel">
                <div class="user-info">
                    <div class="user-avatar" id="user-avatar">JD</div>
                    <div class="user-details">
                        <div class="user-name" id="user-name">John Doe</div>
                        <div class="user-email" id="user-email">john.doe@example.com</div>
                    </div>
                    <button class="logout-btn" id="logout-btn">Logout</button>
                </div>
                
                <div class="progress-container">
                    <div class="progress-label">
                        <span>Interview Progress</span>
                        <span id="progress-value">0%</span>
                    </div>
                    <progress id="interview-progress" value="0" max="100"></progress>
                </div>
                
                <div class="score-breakdown">
                    <h3>Score Breakdown</h3>
                    <div class="score-item">
                        <span>Communication</span>
                        <span id="communication-score">0</span>
                    </div>
                    <div class="score-bar">
                        <div class="score-fill" id="communication-bar" style="width: 0%; background: #3498db;"></div>
                    </div>
                    
                    <div class="score-item">
                        <span>Technical Skills</span>
                        <span id="technical-score">0</span>
                    </div>
                    <div class="score-bar">
                        <div class="score-fill" id="technical-bar" style="width: 0%; background: #2ecc71;"></div>
                    </div>
                    
                    <div class="score-item">
                        <span>Problem Solving</span>
                        <span id="problem-score">0</span>
                    </div>
                    <div class="score-bar">
                        <div class="score-fill" id="problem-bar" style="width: 0%; background: #e74c3c;"></div>
                    </div>
                    
                    <div class="score-item">
                        <span>Culture Fit</span>
                        <span id="culture-score">0</span>
                    </div>
                    <div class="score-bar">
                        <div class="score-fill" id="culture-bar" style="width: 0%; background: #f39c12;"></div>
                    </div>
                </div>
                
                <div class="current-evaluation">
                    <h3>Current Evaluation</h3>
                    <div class="evaluation-text" id="evaluation-text">
                        The interview hasn't started yet. Evaluation will appear here as you progress.
                    </div>
                </div>
            </div>
            
            <div class="chat-container">
                <div class="chat-messages" id="chat-messages">
                    <div class="message bot-message">
                        Hello! I'm your AI Interviewer. I'll be conducting your screening interview today. To get started, could you please introduce yourself and tell me a bit about your background?
                    </div>
                </div>
                
                <div class="typing-indicator" id="typing-indicator">
                    <div class="typing-dots">
                        <div class="typing-dot"></div>
                        <div class="typing-dot"></div>
                        <div class="typing-dot"></div>
                    </div>
                </div>
                
                <div class="input-area">
                    <input type="text" id="user-input" placeholder="Type your answer here..." autocomplete="off">
                    <button id="send-btn">Send</button>
                </div>
            </div>
        </div>
        
        <div class="results-container" id="results-container">
            <div class="score-display">
                <div class="score" id="final-score">0</div>
                <div class="score-label">Overall Score</div>
            </div>
            
            <div class="summary">
                <h3>Evaluation Summary</h3>
                <p id="summary-text">Based on the interview, you demonstrated good communication skills and basic understanding of the role. However, there is room for improvement in technical knowledge and problem-solving abilities.</p>
                
                <h3 style="margin-top: 20px;">Recommendations</h3>
                <p id="recommendations-text">We recommend focusing on developing your technical skills and preparing more detailed examples of problem-solving for your next interview.</p>
            </div>
            
            <div class="action-buttons">
                <button class="download-btn" id="download-btn">Download Full Report (JSON)</button>
                <button class="restart-btn" id="restart-btn">Start New Interview</button>
            </div>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // DOM Elements
            const loginContainer = document.getElementById('login-container');
            const registerContainer = document.getElementById('register-container');
            const mainContent = document.getElementById('main-content');
            const resultsContainer = document.getElementById('results-container');
            const loginForm = document.getElementById('login-form');
            const registerForm = document.getElementById('register-form');
            const showRegisterBtn = document.getElementById('show-register');
            const showLoginBtn = document.getElementById('show-login');
            const loginError = document.getElementById('login-error');
            const registerError = document.getElementById('register-error');
            const logoutBtn = document.getElementById('logout-btn');
            const userAvatar = document.getElementById('user-avatar');
            const userName = document.getElementById('user-name');
            const userEmail = document.getElementById('user-email');
            
            // Chat elements
            const chatMessages = document.getElementById('chat-messages');
            const userInput = document.getElementById('user-input');
            const sendBtn = document.getElementById('send-btn');
            const progressBar = document.getElementById('interview-progress');
            const progressValue = document.getElementById('progress-value');
            const finalScore = document.getElementById('final-score');
            const summaryText = document.getElementById('summary-text');
            const recommendationsText = document.getElementById('recommendations-text');
            const downloadBtn = document.getElementById('download-btn');
            const restartBtn = document.getElementById('restart-btn');
            const typingIndicator = document.getElementById('typing-indicator');
            
            // Score elements
            const commScore = document.getElementById('communication-score');
            const techScore = document.getElementById('technical-score');
            const problemScore = document.getElementById('problem-score');
            const cultureScore = document.getElementById('culture-score');
            const commBar = document.getElementById('communication-bar');
            const techBar = document.getElementById('technical-bar');
            const problemBar = document.getElementById('problem-bar');
            const cultureBar = document.getElementById('culture-bar');
            const evaluationText = document.getElementById('evaluation-text');
            
            // Simulated database (in a real app, this would be on a server)
            const userDatabase = [
                { id: 1, name: "John Doe", email: "john@example.com", password: "password123", avatar: "JD" },
                { id: 2, name: "Jane Smith", email: "jane@example.com", password: "password123", avatar: "JS" },
                { id: 3, name: "Bob Johnson", email: "bob@example.com", password: "password123", avatar: "BJ" }
            ];
            
            let currentUser = null;
            let currentStep = 0;
            let interviewUserName = '';
            let userResponses = [];
            let scores = {
                communication: 0,
                technical: 0,
                problemSolving: 0,
                culture: 0
            };
            
            // Dynamic question bank with different categories
            const questionBank = {
                introduction: [
                    "Hello! I'm your AI Interviewer. I'll be conducting your screening interview today. To get started, could you please introduce yourself and tell me a bit about your background?",
                    "Welcome to your interview! Let's begin with a brief introduction. Can you tell me about yourself and your professional background?"
                ],
                technical: [
                    "Based on your background, I'd like to ask about your technical experience. What programming languages or frameworks are you most comfortable with?",
                    "Let's discuss your technical skills. Can you tell me about a recent technical challenge you faced and how you solved it?",
                    "How do you stay updated with the latest developments and technologies in your field?",
                    "Can you describe your experience with [TECHNOLOGY]? What kind of projects have you used it for?"
                ],
                problemsolving: [
                    "Tell me about a time when you had to solve a complex problem. What was your approach and what was the outcome?",
                    "Describe a situation where you had to make a important decision with limited information. How did you handle it?",
                    "Have you ever faced a situation where your initial solution didn't work? What did you do next?",
                    "Imagine you're working on a project with a tight deadline and unexpected obstacles emerge. How would you handle this situation?"
                ],
                behavioral: [
                    "Tell me about a time you had to work with a difficult team member. How did you handle the situation?",
                    "Describe a situation where you had to take leadership on a project. What was the outcome?",
                    "Can you share an example of when you received constructive criticism? How did you respond?",
                    "Tell me about a time you failed at something. What did you learn from that experience?"
                ],
                cultural: [
                    "What do you value most in a workplace culture?",
                    "How do you prefer to receive feedback on your work?",
                    "What motivates you to do your best work?",
                    "Where do you see yourself in your career in three years?"
                ],
                closing: [
                    "Do you have any questions for me about the role or company?",
                    "Is there anything else you'd like to share about your qualifications or experience?",
                    "We're almost done. Is there anything we haven't covered that you think is important for me to know?"
                ]
            };
            
            let interviewFlow = [
                { type: "introduction", question: questionBank.introduction[0] },
                { type: "technical", question: questionBank.technical[0] },
                { type: "problemsolving", question: questionBank.problemsolving[0] },
                { type: "behavioral", question: questionBank.behavioral[0] },
                { type: "cultural", question: questionBank.cultural[0] },
                { type: "closing", question: questionBank.closing[0] }
            ];
            
            // Event Listeners for Auth
            showRegisterBtn.addEventListener('click', function(e) {
                e.preventDefault();
                loginContainer.style.display = 'none';
                registerContainer.style.display = 'flex';
            });
            
            showLoginBtn.addEventListener('click', function(e) {
                e.preventDefault();
                registerContainer.style.display = 'none';
                loginContainer.style.display = 'flex';
            });
            
            loginForm.addEventListener('submit', function(e) {
                e.preventDefault();
                const email = document.getElementById('email').value;
                const password = document.getElementById('password').value;
                
                // Check credentials against simulated database
                const user = userDatabase.find(u => u.email === email && u.password === password);
                
                if (user) {
                    currentUser = user;
                    loginError.style.display = 'none';
                    showMainApp();
                } else {
                    loginError.style.display = 'block';
                }
            });
            
            registerForm.addEventListener('submit', function(e) {
                e.preventDefault();
                const name = document.getElementById('reg-name').value;
                const email = document.getElementById('reg-email').value;
                const password = document.getElementById('reg-password').value;
                const confirm = document.getElementById('reg-confirm').value;
                
                if (password !== confirm) {
                    registerError.style.display = 'block';
                    return;
                }
                
                // Check if user already exists
                if (userDatabase.find(u => u.email === email)) {
                    registerError.style.display = 'block';
                    return;
                }
                
                // Create new user (in a real app, this would be sent to a server)
                const newUser = {
                    id: userDatabase.length + 1,
                    name: name,
                    email: email,
                    password: password,
                    avatar: name.split(' ').map(n => n[0]).join('')
                };
                
                userDatabase.push(newUser);
                currentUser = newUser;
                
                registerError.style.display = 'none';
                showMainApp();
            });
            
            logoutBtn.addEventListener('click', function() {
                currentUser = null;
                mainContent.style.display = 'none';
                resultsContainer.style.display = 'none';
                loginContainer.style.display = 'flex';
                resetInterview();
            });
            
            // Show the main application after login
            function showMainApp() {
                loginContainer.style.display = 'none';
                registerContainer.style.display = 'none';
                mainContent.style.display = 'flex';
                
                // Update user info
                userAvatar.textContent = currentUser.avatar;
                userName.textContent = currentUser.name;
                userEmail.textContent = currentUser.email;
                
                // Initialize the interview
                initInterview();
            }
            
            // Initialize the interview
            function initInterview() {
                updateProgress();
                userInput.focus();
            }
            
            // Show typing indicator
            function showTypingIndicator() {
                typingIndicator.style.display = 'block';
                chatMessages.scrollTop = chatMessages.scrollHeight;
            }
            
            // Hide typing indicator
            function hideTypingIndicator() {
                typingIndicator.style.display = 'none';
            }
            
            // Add a bot message to the chat
            function addBotMessage(message) {
                const messageEl = document.createElement('div');
                messageEl.classList.add('message', 'bot-message');
                messageEl.textContent = message;
                chatMessages.appendChild(messageEl);
                chatMessages.scrollTop = chatMessages.scrollHeight;
            }
            
            // Add a user message to the chat
            function addUserMessage(message) {
                const messageEl = document.createElement('div');
                messageEl.classList.add('message', 'user-message');
                messageEl.textContent = message;
                chatMessages.appendChild(messageEl);
                chatMessages.scrollTop = chatMessages.scrollHeight;
            }
            
            // Update progress bar
            function updateProgress() {
                const progress = (currentStep / interviewFlow.length) * 100;
                progressBar.value = progress;
                progressValue.textContent = `${Math.round(progress)}%`;
            }
            
            // Simulate AI response analysis
            function analyzeResponse(response, questionType) {
                // This is a simplified simulation of AI analysis
                // In a real application, this would call an AI API
                
                const length = response.length;
                const words = response.split(' ').length;
                const complexity = calculateComplexity(response);
                
                let score = 0;
                let feedback = "";
                
                // Different evaluation criteria based on question type
                switch(questionType) {
                    case "introduction":
                        score = Math.min(10, Math.floor(words / 10) + complexity);
                        feedback = words > 30 ? "Good level of detail in introduction." : "Consider providing more detail in your introduction.";
                        scores.communication += score;
                        break;
                    case "technical":
                        score = Math.min(10, countTechnicalTerms(response) * 2 + complexity);
                        feedback = countTechnicalTerms(response) > 2 ? "Demonstrates good technical knowledge." : "Could benefit from more technical specifics.";
                        scores.technical += score;
                        break;
                    case "problemsolving":
                        score = Math.min(10, Math.floor(words / 15) + complexity);
                        feedback = words > 40 ? "Shows structured problem-solving approach." : "Try to provide more detail about your problem-solving process.";
                        scores.problemSolving += score;
                        break;
                    case "behavioral":
                        score = Math.min(10, Math.floor(words / 12) + complexity);
                        feedback = "Good example provided of workplace behavior.";
                        scores.culture += score;
                        break;
                    case "cultural":
                        score = Math.min(10, Math.floor(words / 8) + complexity);
                        feedback = "Appears to be a good cultural fit.";
                        scores.culture += score;
                        break;
                    default:
                        score = Math.min(10, Math.floor(words / 10));
                        feedback = "Thank you for your response.";
                }
                
                // Update score displays
                updateScoreDisplays();
                
                return { score, feedback };
            }
            
            // Calculate response complexity (simulated)
            function calculateComplexity(text) {
                const longWords = text.split(' ').filter(word => word.length > 6).length;
                const sentences = text.split(/[.!?]+/).length - 1;
                return Math.min(5, Math.floor(longWords / 2) + Math.floor(sentences));
            }
            
            // Count technical terms (simulated)
            function countTechnicalTerms(text) {
                const techTerms = ['python', 'javascript', 'java', 'react', 'node', 'sql', 'database', 'api', 'framework', 'cloud', 'aws', 'azure', 'git', 'docker', 'kubernetes'];
                return techTerms.filter(term => text.toLowerCase().includes(term)).length;
            }
            
            // Update score displays
            function updateScoreDisplays() {
                commScore.textContent = scores.communication;
                techScore.textContent = scores.technical;
                problemScore.textContent = scores.problemSolving;
                cultureScore.textContent = scores.culture;
                
                commBar.style.width = `${scores.communication}%`;
                techBar.style.width = `${scores.technical}%`;
                problemBar.style.width = `${scores.problemSolving}%`;
                cultureBar.style.width = `${scores.culture}%`;
            }
            
            // Process user input
            function processInput() {
                const inputText = userInput.value.trim();
                if (inputText === '') return;
                
                addUserMessage(inputText);
                userInput.value = '';
                sendBtn.disabled = true;
                
                // Store response
                const currentQuestion = interviewFlow[currentStep];
                userResponses.push({
                    question: currentQuestion.question,
                    response: inputText,
                    type: currentQuestion.type
                });
                
                // Simulate AI analysis
                showTypingIndicator();
                
                setTimeout(() => {
                    hideTypingIndicator();
                    
                    const analysis = analyzeResponse(inputText, currentQuestion.type);
                    evaluationText.textContent = analysis.feedback;
                    
                    // Move to next question or end interview
                    currentStep++;
                    
                    if (currentStep < interviewFlow.length) {
                        // Get next question - in a real AI system, this would be dynamic based on the response
                        const nextQuestion = interviewFlow[currentStep].question;
                        
                        addBotMessage(nextQuestion);
                        updateProgress();
                    } else {
                        endInterview();
                    }
                    
                    sendBtn.disabled = false;
                    userInput.focus();
                }, 2000);
            }
            
            // End the interview and show results
            function endInterview() {
                mainContent.style.display = 'none';
                resultsContainer.style.display = 'flex';
                
                // Calculate final score (out of 50)
                const totalScore = Math.min(50, 
                    scores.communication + 
                    scores.technical + 
                    scores.problemSolving + 
                    scores.culture
                );
                
                finalScore.textContent = totalScore;
                
                // Generate summary based on score
                if (totalScore >= 40) {
                    summaryText.textContent = `Excellent performance${interviewUserName ? ', ' + interviewUserName : ''}! You demonstrated strong communication skills, deep technical knowledge, and excellent problem-solving abilities. Your responses indicated a great cultural fit as well.`;
                    recommendationsText.textContent = "You appear to be a strong candidate for this role. We recommend proceeding to the next stage of the interview process.";
                } else if (totalScore >= 30) {
                    summaryText.textContent = `Good performance${interviewUserName ? ', ' + interviewUserName : ''}. You showed a good understanding of the role and have relevant experience. There's room for improvement in technical depth and specific examples.`;
                    recommendationsText.textContent = "We recommend brushing up on technical specifics and preparing more detailed examples of problem-solving for your next interview.";
                } else if (totalScore >= 20) {
                    summaryText.textContent = `Fair performance${interviewUserName ? ', ' + interviewUserName : ''}. You have some relevant background but need to strengthen your technical knowledge and understanding of the role's requirements.`;
                    recommendationsText.textContent = "We recommend focusing on developing your technical skills and gaining more experience before reapplying.";
                } else {
                    summaryText.textContent = `We appreciate your time${interviewUserName ? ', ' + interviewUserName : ''}. Based on this interview, we recommend further preparation in developing relevant skills and understanding of the role before proceeding.`;
                    recommendationsText.textContent = "Consider taking online courses or gaining practical experience in the required skills before your next interview.";
                }
            }
            
            // Reset interview for a new session
            function resetInterview() {
                currentStep = 0;
                interviewUserName = '';
                userResponses = [];
                scores = {
                    communication: 0,
                    technical: 0,
                    problemSolving: 0,
                    culture: 0
                };
                
                // Clear chat
                chatMessages.innerHTML = '<div class="message bot-message">Hello! I\'m your AI Interviewer. I\'ll be conducting your screening interview today. To get started, could you please introduce yourself and tell me a bit about your background?</div>';
                
                // Reset scores
                updateScoreDisplays();
                evaluationText.textContent = "The interview hasn't started yet. Evaluation will appear here as you progress.";
                
                // Update progress
                updateProgress();
            }
            
            // Generate and download JSON results
            function downloadResults() {
                const results = {
                    candidate: currentUser.name,
                    email: currentUser.email,
                    timestamp: new Date().toISOString(),
                    score: parseInt(finalScore.textContent),
                    max_score: 50,
                    evaluation: summaryText.textContent,
                    recommendations: recommendationsText.textContent,
                    responses: userResponses
                };
                
                const dataStr = "data:text/json;charset=utf-8," + encodeURIComponent(JSON.stringify(results, null, 2));
                const downloadAnchor = document.createElement('a');
                downloadAnchor.setAttribute("href", dataStr);
                downloadAnchor.setAttribute("download", `interview_results_${currentUser.name}_${new Date().getTime()}.json`);
                document.body.appendChild(downloadAnchor);
                downloadAnchor.click();
                downloadAnchor.remove();
            }
            
            // Event listeners for chat
            sendBtn.addEventListener('click', processInput);
            userInput.addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    processInput();
                }
            });
            
            downloadBtn.addEventListener('click', downloadResults);
            restartBtn.addEventListener('click', function() {
                resultsContainer.style.display = 'none';
                mainContent.style.display = 'flex';
                resetInterview();
                initInterview();
            });
            
            // Extract name from introduction
            userInput.addEventListener('blur', function() {
                if (currentStep === 0 && userInput.value.trim() !== '' && !interviewUserName) {
                    const input = userInput.value.trim();
                    // Simple name extraction (first word or two)
                    const words = input.split(' ');
                    if (words.length >= 2) {
                        interviewUserName = words[0] + ' ' + words[1];
                    } else if (words.length === 1) {
                        interviewUserName = words[0];
                    }
                }
            });
        });
    </script>
</body>
</html>